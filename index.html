<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>RPG Maker AI Translator ULTIMATE v4.0</title>
  <meta name="description" content="Client-side RPG Maker MV/MZ JSON Translator with AI, Live Preview and Safety Modes." />
  <meta name="theme-color" content="#071026" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
<noscript>
  <div style="padding:16px;background:#b00020;color:#fff;text-align:center">
    Ứng dụng này cần bật JavaScript để hoạt động.
  </div>
</noscript>

<div id="app" class="app-shell">

  <!-- ================= Header ================= -->
  <header class="app-header">
    <div class="brand">
      <div class="logo">⚛</div>
      <div class="brand-text">
        <h1>
          RPG Maker AI Translator
          <span class="version">ULTIMATE v4.0</span>
        </h1>
        <p class="tagline">Live Preview • Plugin Protection • Client-side AI</p>
      </div>
    </div>

    <div class="header-actions">
      <span id="apiStatus" class="badge safe">Idle</span>
      <button id="installBtn" class="btn small ghost" hidden>Install</button>
    </div>
  </header>

  <!-- ================= Main ================= -->
  <main class="grid">

    <!-- ===== Controls ===== -->
    <section class="panel controls">
      <h2>Configuration</h2>

      <!-- API Key -->
      <div class="form-row">
        <label for="apiKey">DeepSeek API Key</label>
        <input
          id="apiKey"
          type="password"
          placeholder="sk-xxxxxxxx"
          autocomplete="off"
        />
        <small class="muted">
          API key chỉ lưu trên trình duyệt, không gửi đi nơi khác.
        </small>
      </div>

      <!-- Languages -->
      <div class="row-split">
        <div class="form-row">
          <label for="sourceLang">Source Language</label>
          <select id="sourceLang">
            <option value="ja">Japanese</option>
            <option value="en">English</option>
            <option value="zh">Chinese</option>
            <option value="ko">Korean</option>
          </select>
        </div>

        <div class="form-row">
          <label for="targetLang">Target Language</label>
          <select id="targetLang">
            <option value="vi">Vietnamese</option>
            <option value="en">English</option>
            <option value="zh">Chinese</option>
            <option value="ko">Korean</option>
          </select>
        </div>
      </div>

      <!-- Safety -->
      <div class="form-row">
        <label for="safeMode">Safety Mode</label>
        <select id="safeMode">
          <option value="strict">STRICT – Maximum safety</option>
          <option value="balanced" selected>BALANCED – Recommended</option>
          <option value="aggressive">AGGRESSIVE – Risky</option>
        </select>
      </div>

      <!-- Batch -->
      <div class="row-split">
        <div class="form-row">
          <label for="batchSize">Batch Size</label>
          <input id="batchSize" type="number" min="1" max="50" value="10" />
        </div>

        <div class="form-row">
          <label class="checkbox">
            <input type="checkbox" id="preserveFormatting" checked />
            Preserve formatting
          </label>
        </div>
      </div>

      <!-- Upload -->
      <div id="dropZone" class="upload-area">
        <div class="upload-inner">
          <p class="big">Drag & Drop JSON files</p>
          <p class="muted">Maps, Database, CommonEvents (MV / MZ)</p>
          <button id="selectFiles" class="btn small">Select files</button>
          <input id="fileInput" type="file" accept=".json" multiple hidden />
        </div>
      </div>

      <div id="fileList" class="file-list"></div>

      <!-- Actions -->
      <div class="controls-actions">
        <button id="startBtn" class="btn primary">Start</button>
        <button id="pauseBtn" class="btn ghost" disabled>Pause</button>
        <button id="clearBtn" class="btn hollow">Clear</button>
      </div>

      <!-- Safety Legend -->
      <div class="safety-indicators">
        <span class="badge protected">PROTECTED</span>
        <span class="badge safe">SAFE</span>
        <span class="badge risky">RISKY</span>
        <span class="badge blocked">BLOCKED</span>
      </div>
    </section>

    <!-- ===== Preview ===== -->
    <section class="panel preview">
      <div class="preview-toolbar">
        <h2>Live Preview</h2>

        <div class="preview-controls">
          <input
            id="previewSearch"
            type="search"
            placeholder="Search… (Ctrl + K)"
          />
          <button id="toggleAutoScroll" class="btn small ghost active">
            Auto-scroll
          </button>
          <button id="exportBtn" class="btn small">Export</button>
        </div>
      </div>

      <div id="previewStream" class="preview-stream">
        <div class="preview-empty">
          <p>No translations yet.</p>
        </div>
      </div>

      <!-- Progress -->
      <div class="progress-area">
        <div class="progress-row">
          <progress id="batchProgress" value="0" max="100"></progress>
          <span id="batchMeta" class="text-muted">0 / 0</span>
        </div>

        <div class="stats-row">
          <div class="stat">
            <div id="textsTranslated" class="stat-value">0</div>
            <div class="stat-label">Texts</div>
          </div>
          <div class="stat">
            <div id="estCost" class="stat-value">$0.0000</div>
            <div class="stat-label">Estimated cost</div>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ================= Footer ================= -->
  <footer class="app-footer">
    <span class="text-muted">
      © RPG Maker AI Translator ULTIMATE v4.0
    </span>
    <span class="text-muted">
      Client-side • No tracking • Safe by design
    </span>
  </footer>

</div>

<!-- Scripts -->
<script type="module" src="script.js"></script>
</body>
</html>